@model WebTaskMaster.Models.Project.ProjectDetailsModel


@{
	ViewData["Title"] = Model.Name;
	ViewData["projectId"] = Model.Id;
}


<div class="projectWraper">
	<div class="title">
		Project info
	</div>
	<div class="tabs_wrapNew">
		<ul>
			<li data-tabs="info" class="active">Project information</li>
			<li data-tabs="task">Tasks</li>

		</ul>

	</div>
	<ul class="section">
		<li class="item_wrapNew info online">
			<div>
				<div class="project-decription">
					 
					<!-- Project name and description -->
					<div class="container text-center  project-info-dashboard shadow  ">
						<div class="row justify-content-center align-items-center py-5 mb-2  text-center  team-style">
							<p class="col-12 col-sm-8 order-first h2   display-4  lol      ">
								@Model.Name

								
							</p>
							@if (!string.IsNullOrWhiteSpace(Model.Description))
							{
								<span class="fs-4 fst-italic fw-lighter text-center text-dark d-block my-1">@Model.Description</span>
							}
							@* Edit project name and description modal button *@
							<button class="btn btn-outline-warning col-12 col-sm-1 rounded-5"
									data-bs-toggle="modal" data-bs-target="#editProjectModal"
									data-bs-toggle-tooltip="tooltip" data-bs-trigger="hover" data-bs-title="Edit name and/or description">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
									<path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z" />
								</svg>
								Edit
								<span class="lnr lnr-pencil"></span>
							</button>

							@* Delete Project Modal button  *@
							<button type="button" class="btn btn-outline-danger col-12 col-sm-1 rounded-5"
									data-bs-toggle="modal" data-bs-target="#deleteProjectModal"
									data-bs-toggle-tooltip="tooltip" data-bs-trigger="hover" data-bs-title="Delete project">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
									<path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z" />
									<path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z" />
								</svg>
								Delete
							</button>
						</div>


						<!--  Team Description -->
						@foreach (var Ekipa in Model.Teams)
						{
							<div class="row  col-3 text-start px-2 mb-2 border-start border-primary border-opacity-50 border-5  mx-5 m-bottom-5 shadow p-3 mb-5 bg-body rounded">
								<p class="h-1 text-uppercase text-primary text-opacity-75 fw-bold px-5">@Ekipa.Name</p>
								<p class="text-dark"> @Ekipa.Id</p>
								<button class="btn btn-info"></button>
								<button class="btn btn-danger"></button>
								<button class="btn btn-outline-success"></button>
							</div>
						}

						<div class="row justify-content-end text-start px-2 mb-2 border-start border-primary border-opacity-75 border-5 rounded-2 mx-5 m-bottom-5 shadow p-3 mb-5 bg-body rounded">
							<p class="h-1 text-uppercase text-primary text-opacity-75 fw-bold px-5">Project Team</p>
						  

							@for (var index = 0; index < Model.Teams.Count; index++)
							{
								var team = Model.Teams[index];

								<p class="fs-3 col-12 col-sm-12 align-content-end text-start text-uppercase px-5 text-dark "> @team.Name</p>


								<a class=" btn btn-outline-primary btn-sm col-12 col-sm-2 rounded-5 justify-content-end fs-6"
								   asp-controller="Team" asp-action="Details" asp-route-teamId="@team.Id"
								   data-bs-toggle-tooltip="tooltip" data-bs-trigger="hover" data-bs-title="Team details">
									<label asp-for="ProjectTeam"><i class="bi bi-people"></i> Details</label>

								</a>

								@* Add Team Modal button *@
								<button id="addTeamModalBtn" class="btn btn-outline-warning btn-sm col-12 justify-content-end col-sm-1 rounded-5" type="button"
										data-bs-toggle="modal" data-bs-target="#addTeamModal"
										data-bs-toggle-tooltip="tooltip" data-bs-trigger="hover" data-bs-title="Add team">
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
										<path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z" />
									</svg>
									Change
								</button>

								@* Delete Team Modal button *@
								<button class="btn btn-outline-danger btn-sm col-12 col-sm-1 rounded-5 justify-content-end" type="button"
										data-bs-toggle="modal" data-bs-target="#deleteTeamModal" data-bs-link-id="link@(index)"
										data-bs-toggle-tooltip="tooltip" data-bs-trigger="hover" data-bs-title="Delete team">
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
										<path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z" />
										<path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z" />
									</svg>
									Delete
									<span class="lnr lnr-pencil"></span>
								</button>

								@* hidden link for modal *@
								<a id="link@(index)" hidden asp-action="DeleteTeam" asp-route-projectId="@Model.Id" asp-route-teamId="@team.Id"></a>
							}
							<br />
							@* Add Team button *@
							<button id="addTeamModalBtn" class="btn btn-orange col-12 justify-content-end col-sm-1 col-xl-2" type="button"
									data-bs-toggle="modal" data-bs-target="#addTeamModal"
									data-bs-toggle-tooltip="tooltip" data-bs-trigger="hover" data-bs-title="Add team">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
									<path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z" />
								</svg>
							</button>
							<!--  Task Description -->
							@* <div class="row justify-content-end text-start px-2 mb-2 border-start border-success border-opacity-75 border-5 rounded-2 mx-5 m-bottom-5 shadow = p-3 mb-5 bg-body rounded">
							<p class="h-1 text-uppercase text-success text-opacity-75 fw-bold px-5">Project Tasks</p>
							</div> *@

							@* <div class="row justify-content-center px-2 py-2 mb-2 bg-primary bg-opacity-10">
							@* <h5 class="col-12 col-sm-11 order-first">Zadania</h5> *@
							@* <label class="fs-5 col-12 col-sm-11 order-first" asp-for="Tasks"></label> *@

							@* Add Task Modal button *@
							@*  <button id="addTaskModalBtn" class="btn btn-primary col-12 col-sm-1 order-sm-1" type="button"
							data-bs-toggle="modal" data-bs-target="#addTasksModal"
							data-bs-toggle-tooltip="tooltip" data-bs-trigger="hover" data-bs-title="Add task">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
							<path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
							</svg>
							</button>
							</div> *@
						</div>



						@* Edit team name and description modal *@
						<partial name="_EditPartial" model="Model.ProjectEditModel" />
						@* Add Team Modal *@
						<partial name="_ChangeTeamPartial" model="Model.ProjectAddTeamModel" />
					</div>

					@* Delete Team from Project Modal *@
					<div id="deleteTeamModal" class="modal fade text-dark">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<h1 class="modal-title fs-5">Delete team</h1>
									<button class="btn-close" type="button" data-bs-dismiss="modal"></button>
								</div>
								<div class="modal-body">
									<span>Are you sure you want to remove a team from current project?</span>
								</div>
								<div class="modal-footer">
									@* Href will be set on modal activation. *@
									<a id="confirmTeamDeleteBtn" class="btn btn-danger px-5 mx-5">Yes</a>

									<button class="btn btn-primary px-5 mx-5" type="button" data-bs-dismiss="modal">No</button>
								</div>
							</div>
						</div>
					</div>



					<!--  and   -->
					<!-- team and button to add new team-->
					<!-- info about tasks-->
					<div class="block-progress-toDo">toDo</div>
					<div class="block-progress-inProgress">inProgress</div>
					<div class="block-progress-Done">Done</div>
					<!--  and   -->
				</div>
			</div>
		</li>
		<li class="item_wrapNew task online">
			<div class="item">
				<div class="item_left">

					<!-- Task  to-do/inprogres/done -->
					@*Tasks*@
					<div class="task">
						<partial name="_TasksList" model="Model" />
					</div>

					<!--  and   -->
					<!-- add new task-->
					<!--  and   -->
					<div class="block-progress-toDo">POKA</div>


				</div>
			</div>
		</li>
	</ul>
</div>


@* Delete Project Modal *@
<div id="deleteProjectModal" class="modal fade text-dark">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h1 class="modal-title fs-5">Delete project</h1>
				<button class="btn-close" type="button" data-bs-dismiss="modal"></button>
			</div>
			<div class="modal-body">
				<span>Are you sure you want to delete this project?</span>
			</div>
			<div class="modal-footer">
				<a class="btn btn-danger px-5 mx-5" asp-action="Delete" asp-route-projectId="@Model.Id">Yes</a>
				<button class="btn btn-primary px-5 mx-5" type="button" data-bs-dismiss="modal">No</button>
			</div>
		</div>
	</div>
</div>

<script src="~/js/AnotherTabs.js" asp-append-version="true"></script>




<partial name="_ToastPartial" />

@section Scripts
	{
	@{
		var modalBtnId = ViewData["ActivateModal"] switch
		{
			"AddTeam" => "addTeamModalBtn",
			"Add" => "addTeamModal",
			"Edit" => "editProjectModal",
			_ => null
		};

		await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}

	@* Activate modal on page load. Needed to display server side validation result. *@
	@if (modalBtnId is not null)
	{
		<script type="text/javascript">
			$(document).ready(function () {
				document.getElementById("@modalBtnId").click();
			});
		</script>
	}

	@* Set hidden link for delete team member modal.*@
	<script type="text/javascript">
		document.getElementById('deleteTeamModal').addEventListener('show.bs.modal', event => {
			var btn = event.relatedTarget;

			var linkId = $(btn).attr('data-bs-link-id');

			$('#confirmTeamDeleteBtn').attr('href', $('#' + linkId).attr('href'));
		})
	</script>

	@* tooltips *@
	<script type="text/javascript">
		tooltipTriggerList = document.querySelectorAll('[data-bs-toggle-tooltip="tooltip"]');
		tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
	</script>

	@* show toast for team edit response
	@if (TempData["ToastMessage"] is not null)
	{
	<script type="text/javascript">
	bootstrap.Toast.getOrCreateInstance(document.getElementById('toast')).show();
	</script>
	}*@
	}
